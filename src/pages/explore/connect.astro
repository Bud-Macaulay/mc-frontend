---
import Layout from "@layouts/Layout.astro";

const breadcrumbs = [
  { name: "Explore", href: "explore" },
  { name: "Connect to your REST API", href: null },
];

const codeStyle = "block bg-slate-100 px-2 py-1 font-mono text-sm";
---

<Layout breadcrumbs={breadcrumbs}>
  <h3 class="pb-2">Connect your REST API</h3>
  <hr class="border-t border-gray-300 mb-4" />

  <section class="space-y-6 mx-8 p-0">
    <h3>Instructions</h3>

    <div class="space-y-4">
      <h4>Step 1: Running the REST API</h4>
      <p>On your local AiiDA computer run on the command line:</p>
      <code class={codeStyle}>$ verdi restapi</code>

      <p>
        This command starts the REST API with the default parameters (default
        AiiDA profile, port 5000 of localhost). If your version of AiiDA is
        equal to 1.0.1 or later, its base URL is:
      </p>
      <code class={codeStyle}>http://127.0.0.1:5000/api/v4</code>

      <p>
        If your version of AiiDA is from 1.0.0b3 to 1.0.0b6, the base URL is:
      </p>
      <code class={codeStyle}>http://127.0.0.1:5000/api/v3</code>

      <p>
        If your version of AiiDA is previous or equal to 1.0.0b2, the base URL
        is:
      </p>
      <code class={codeStyle}>http://127.0.0.1:5000/api/v2</code>

      <p class="italic text-gray-700">
        Note that the REST API of the AiiDA 1.0.0 version is not supported; you
        should upgrade to 1.0.1 or to a later version to use the "Connect to
        your AiiDA REST API" feature.
      </p>
    </div>
  </section>
  <section class="space-y-4 mx-8 pt-8">
    <h4>Step 2: Connecting to your REST API</h4>

    <p>
      Type the base URL in the input box above and click <span
        class="font-semibold">"GO!"</span
      > to browse your own data in the Explore section. To directly connect to your
      AiiDA REST API you can also pass the <em>base_url</em> parameter to the url
      query string, e.g.:
    </p>

    <p>
      <a
        href="https://dev-www.materialscloud.org/explore/ownrestapi?base_url=http://127.0.0.1:5000/api/v4"
        >https://dev-www.materialscloud.org/explore/ownrestapi?base_url=http://127.0.0.1:5000/api/v4</a
      >
    </p>

    <p>
      Note that if the backend of your AiiDA profile is SQLAlchemy, you might
      have to reload the page after the first connection to your REST API in
      order to correctly load the nodes dashboard.
      <br />
      If you notice other issues please report them
      <a href="https://github.com/materialscloud-org/issues">here</a>.
    </p>

    <p class="font-semibold">
      Note: all data remains local to your computer and is not transferred to
      Materials Cloud.
    </p>

    <p>
      For more information on the REST API see the
      <a
        href="https://aiida-core.readthedocs.io/en/latest/restapi/index.html"
        target="_blank">AiiDA documentation</a
      >.
    </p>
  </section>
</Layout>
